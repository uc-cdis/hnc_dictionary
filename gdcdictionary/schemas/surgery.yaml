$schema: "http://json-schema.org/draft-04/schema#"

id: "surgery"
title: Surgery
type: object
namespace: https://imaging-hub.data-commons.org 
category: clinical
program: '*'
project: '*'
description: >
  Surgery
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - state
  - created_datetime
  - updated_datetime

links:
  - exclusive: false
    required: true
    subgroup:
      - name: diagnosis
        backref: surgery
        label: describes
        target_type: diagnosis
        multiplicity: many_to_one
        required: false
      - name: subject
        backref: surgery
        label: describes
        target_type: subject
        multiplicity: many_to_one
        required: false
      - name: visit
        backref: surgery
        label: describes
        target_type: visit
        multiplicity: many_to_one
        required: false

uniqueKeys:
  - [id]
  - [project_id, submitter_id]

required:
  - submitter_id
  - type

properties:
  $ref: "_definitions.yaml#/ubiquitous_properties"


  # surgical tx from ENT_CA_DM_SURG_fake.txt
  admit_time:
    type: string
    description: day/time patient admitted to hospital
  disch_time:
    type: string
    description: day/time patient discharged from hospital
  SCHED_START_TIME:
    type: string
    description: scheduled start time
  proc_start_time:
    type: string
    description: day/time of procedure start
  proc_end_time:
    type: string
    description: day/time of procedure end
  cpt_code:
    type: string
    description: Current Procedural Terminology (CPT) codes are a set of numeric codes that identify medical procedures and services. There is some missingness to this data but in theory could be used to accurately code surgical procedures to reference an external database.
  PROC_NAME:
    type: string
    description: procedure name
  PROV_NAME:
    type: string
    description: name of provider/surgeon performing surgery
  Sched_status:
    type: string
    description: status of surgery (scheduled, unscheduled, cancelled, completed)


  diagnosis:
    description: The submitter_id or id of the diagnosis this surgery belongs to, i.e., a link to a record in the parent node.
    $ref: "_definitions.yaml#/to_one"
  subject:
    description: The submitter_id or id of the subject this surgery belongs to, i.e., a link to a record in the parent node.
    $ref: "_definitions.yaml#/to_one"
  visit:
    description: The submitter_id or id of the visit this surgery belongs to, i.e., a link to a record in the parent node.
    $ref: "_definitions.yaml#/to_one"
